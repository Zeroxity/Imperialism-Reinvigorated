# CLIMATE
IR_check_climate = {
	hidden_effect = {
		set_variable = { which = IR_prov_climate value = 0 }
		if = {
			limit = { has_global_flag = IR_global_climate_A }
			trigger_switch = {
				on_trigger = has_province_modifier
				climate_sicco = { set_variable = { which = IR_prov_pop_cap value = 2 } }
				climate_xeric = { set_variable = { which = IR_prov_pop_cap value = 3 } } 
				climate_veldt = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_montane = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_polar = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				#
				climate_outback = { set_variable = { which = IR_prov_pop_cap value = 3 } }
				climate_levante = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				climate_chaco = { set_variable = { which = IR_prov_pop_cap value = 7 } }
				climate_pratumic = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_boreal = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				#
				climate_chaparral = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				climate_mediterranean = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_temperate = { set_variable = { which = IR_prov_pop_cap value = 9 } }
				climate_continental = { set_variable = { which = IR_prov_pop_cap value = 8 } }
				climate_hemiboreal = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				#
				climate_cerradic = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_calidic = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_mesothermal = { set_variable = { which = IR_prov_pop_cap value = 8 } }
				climate_nemoral = { set_variable = { which = IR_prov_pop_cap value = 7 } }
				climate_oceanic = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				#
				climate_tropical = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_pantanal = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_subtropical = { set_variable = { which = IR_prov_pop_cap value = 7 } }
				climate_cascadic = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_maritime = { set_variable = { which = IR_prov_pop_cap value = 5 } }
			}
		}
		else_if = {
			limit = { has_global_flag = IR_global_climate_0 }
			trigger_switch = {
				on_trigger = has_province_modifier
				climate_sicco = { set_variable = { which = IR_prov_pop_cap value = 2 } }
				climate_xeric = { set_variable = { which = IR_prov_pop_cap value = 4 } } 
				climate_veldt = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_montane = { set_variable = { which = IR_prov_pop_cap value = 3 } }
				climate_polar = { set_variable = { which = IR_prov_pop_cap value = 2 } }
				#
				climate_outback = { set_variable = { which = IR_prov_pop_cap value = 3 } }
				climate_levante = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_chaco = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_pratumic = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				climate_boreal = { set_variable = { which = IR_prov_pop_cap value = 3 } }
				#
				climate_chaparral = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				climate_mediterranean = { set_variable = { which = IR_prov_pop_cap value = 7 } }
				climate_temperate = { set_variable = { which = IR_prov_pop_cap value = 8 } }
				climate_continental = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_hemiboreal = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				#
				climate_cerradic = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_calidic = { set_variable = { which = IR_prov_pop_cap value = 7 } }
				climate_mesothermal = { set_variable = { which = IR_prov_pop_cap value = 7 } }
				climate_nemoral = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_oceanic = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				#
				climate_tropical = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_pantanal = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_subtropical = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_cascadic = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				climate_maritime = { set_variable = { which = IR_prov_pop_cap value = 3 } }
			}
		}
		else_if = {
			limit = { has_global_flag = IR_global_climate_1 }
			trigger_switch = {
				on_trigger = has_province_modifier
				climate_sicco = { set_variable = { which = IR_prov_pop_cap value = 3 } }
				climate_xeric = { set_variable = { which = IR_prov_pop_cap value = 5 } } 
				climate_veldt = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				climate_montane = { set_variable = { which = IR_prov_pop_cap value = 2 } }
				climate_polar = { set_variable = { which = IR_prov_pop_cap value = 1 } }
				#
				climate_outback = { set_variable = { which = IR_prov_pop_cap value = 3 } }
				climate_levante = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_chaco = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_pratumic = { set_variable = { which = IR_prov_pop_cap value = 3 } }
				climate_boreal = { set_variable = { which = IR_prov_pop_cap value = 1 } }
				#
				climate_chaparral = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_mediterranean = { set_variable = { which = IR_prov_pop_cap value = 8 } }
				climate_temperate = { set_variable = { which = IR_prov_pop_cap value = 7 } }
				climate_continental = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_hemiboreal = { set_variable = { which = IR_prov_pop_cap value = 2 } }
				#
				climate_cerradic = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_calidic = { set_variable = { which = IR_prov_pop_cap value = 9 } }
				climate_mesothermal = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_nemoral = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				climate_oceanic = { set_variable = { which = IR_prov_pop_cap value = 2 } }
				#
				climate_tropical = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_pantanal = { set_variable = { which = IR_prov_pop_cap value = 7 } }
				climate_subtropical = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_cascadic = { set_variable = { which = IR_prov_pop_cap value = 3 } }
				climate_maritime = { set_variable = { which = IR_prov_pop_cap value = 2 } }
			}
		}
		else_if = {
			limit = { has_global_flag = IR_global_climate_2 }
			trigger_switch = {
				on_trigger = has_province_modifier
				climate_sicco = { set_variable = { which = IR_prov_pop_cap value = 3 } }
				climate_xeric = { set_variable = { which = IR_prov_pop_cap value = 4 } } 
				climate_veldt = { set_variable = { which = IR_prov_pop_cap value = 3 } }
				climate_montane = { set_variable = { which = IR_prov_pop_cap value = 1 } }
				climate_polar = { set_variable = { which = IR_prov_pop_cap value = 0 } }
				#
				climate_outback = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				climate_levante = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_chaco = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				climate_pratumic = { set_variable = { which = IR_prov_pop_cap value = 1 } }
				climate_boreal = { set_variable = { which = IR_prov_pop_cap value = 0 } }
				#
				climate_chaparral = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_mediterranean = { set_variable = { which = IR_prov_pop_cap value = 7 } }
				climate_temperate = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_continental = { set_variable = { which = IR_prov_pop_cap value = 3 } }
				climate_hemiboreal = { set_variable = { which = IR_prov_pop_cap value = 1 } }
				#
				climate_cerradic = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_calidic = { set_variable = { which = IR_prov_pop_cap value = 7 } }
				climate_mesothermal = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_nemoral = { set_variable = { which = IR_prov_pop_cap value = 2 } }
				climate_oceanic = { set_variable = { which = IR_prov_pop_cap value = 1 } }
				#
				climate_tropical = { set_variable = { which = IR_prov_pop_cap value = 7 } }
				climate_pantanal = { set_variable = { which = IR_prov_pop_cap value = 7 } }
				climate_subtropical = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				climate_cascadic = { set_variable = { which = IR_prov_pop_cap value = 2 } }
				climate_maritime = { set_variable = { which = IR_prov_pop_cap value = 1 } }
			}
		}
		else_if = {
			limit = { has_global_flag = IR_global_climate_3 }
			trigger_switch = {
				on_trigger = has_province_modifier
				climate_sicco = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				climate_xeric = { set_variable = { which = IR_prov_pop_cap value = 3 } } 
				climate_veldt = { set_variable = { which = IR_prov_pop_cap value = 2 } }
				climate_montane = { set_variable = { which = IR_prov_pop_cap value = 0 } }
				climate_polar = { set_variable = { which = IR_prov_pop_cap value = 0 } }
				#
				climate_outback = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_levante = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				climate_chaco = { set_variable = { which = IR_prov_pop_cap value = 2 } }
				climate_pratumic = { set_variable = { which = IR_prov_pop_cap value = 0 } }
				climate_boreal = { set_variable = { which = IR_prov_pop_cap value = 0 } }
				#
				climate_chaparral = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_mediterranean = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_temperate = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				climate_continental = { set_variable = { which = IR_prov_pop_cap value = 2 } }
				climate_hemiboreal = { set_variable = { which = IR_prov_pop_cap value = 0 } }
				#
				climate_cerradic = { set_variable = { which = IR_prov_pop_cap value = 7 } }
				climate_calidic = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_mesothermal = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				climate_nemoral = { set_variable = { which = IR_prov_pop_cap value = 1 } }
				climate_oceanic = { set_variable = { which = IR_prov_pop_cap value = 0 } }
				#
				climate_tropical = { set_variable = { which = IR_prov_pop_cap value = 7 } }
				climate_pantanal = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_subtropical = { set_variable = { which = IR_prov_pop_cap value = 3 } }
				climate_cascadic = { set_variable = { which = IR_prov_pop_cap value = 1 } }
				climate_maritime = { set_variable = { which = IR_prov_pop_cap value = 0 } }
			}
		}
		else_if = {
			limit = { has_global_flag = IR_global_climate_4 }
			trigger_switch = {
				on_trigger = has_province_modifier
				climate_sicco = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				climate_xeric = { set_variable = { which = IR_prov_pop_cap value = 2 } } 
				climate_veldt = { set_variable = { which = IR_prov_pop_cap value = 1 } }
				climate_montane = { set_variable = { which = IR_prov_pop_cap value = 0 } }
				climate_polar = { set_variable = { which = IR_prov_pop_cap value = 0 } }
				#
				climate_outback = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_levante = { set_variable = { which = IR_prov_pop_cap value = 3 } }
				climate_chaco = { set_variable = { which = IR_prov_pop_cap value = 1 } }
				climate_pratumic = { set_variable = { which = IR_prov_pop_cap value = 0 } }
				climate_boreal = { set_variable = { which = IR_prov_pop_cap value = 0 } }
				#
				climate_chaparral = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_mediterranean = { set_variable = { which = IR_prov_pop_cap value = 4 } }
				climate_temperate = { set_variable = { which = IR_prov_pop_cap value = 3 } }
				climate_continental = { set_variable = { which = IR_prov_pop_cap value = 1 } }
				climate_hemiboreal = { set_variable = { which = IR_prov_pop_cap value = 0 } }
				#
				climate_cerradic = { set_variable = { which = IR_prov_pop_cap value = 7 } }
				climate_calidic = { set_variable = { which = IR_prov_pop_cap value = 5 } }
				climate_mesothermal = { set_variable = { which = IR_prov_pop_cap value = 3 } }
				climate_nemoral = { set_variable = { which = IR_prov_pop_cap value = 0 } }
				climate_oceanic = { set_variable = { which = IR_prov_pop_cap value = 0 } }
				#
				climate_tropical = { set_variable = { which = IR_prov_pop_cap value = 8 } }
				climate_pantanal = { set_variable = { which = IR_prov_pop_cap value = 6 } }
				climate_subtropical = { set_variable = { which = IR_prov_pop_cap value = 2 } }
				climate_cascadic = { set_variable = { which = IR_prov_pop_cap value = 0 } }
				climate_maritime = { set_variable = { which = IR_prov_pop_cap value = 0 } }
			}
		}
		#for dynamic localization purposes
		change_variable = {
			which = IR_prov_climate
			which = IR_prov_pop_cap
		}
	}
}

# DEVELOPMENT
IR_check_dev_variables = {
	hidden_effect = {
		set_variable = { which = IR_wealth_production value = 0 }
		set_variable = { which = IR_pop_production value = 0 }
		set_variable = { which = IR_logistics value = 0 }
		set_variable = { which = IR_consumption value = 0 }
		set_variable = { which = IR_prov_pop value = 0 }
		set_variable = { which = IR_prov_infrastructure value = 0 }
		set_variable = { which = IR_trade_value value = 0 }
		set_variable = { which = IR_price_mod value = 0 }
		set_variable = { which = IR_InfrPrjCC value = 0 }
		set_variable = { which = IR_InfrPrjIL value = 0 }
		#set_variable = { which = IR_demand_value value = 0 }
		set_variable = { which = IR_goods_size value = 0 }
		set_variable = { which = IR_goods_size_mod value = 0 }
		

		#EXPORT DEV FOR CHECKS
		export_to_variable = {
			variable_name = IR_logistics
			value = modifier:local_development_cost
		}
		export_to_variable = {
			variable_name = IR_prov_infrastructure
			value = trigger_value:base_production
		}
		export_to_variable = {
			variable_name = IR_prov_pop
			value = trigger_value:base_manpower
		}
		###
		#export_to_variable = {
		#	variable_name = IR_trade_value
		#	value = modifier:trade_goods_size 
		#}
		#export_to_variable = {
		#	variable_name = IR_goods_size_mod
		#	value = modifier:trade_goods_size_modifier 
		#}
		### rewrite
		export_to_variable = { 
			which = IR_goods_size_mod 
			value = modifier:global_trade_goods_size_modifier 
			who = owner 
		}
		change_variable = { 
			which = IR_goods_size_mod 
			value = 1 
		}
		export_to_variable = { 
			which = IR_goods_size 
			value = modifier:trade_goods_size_modifier 
		}
		change_variable = { 
			which = IR_goods_size_mod 
			which = IR_goods_size
		}
		export_to_variable = { 
			which = IR_goods_size
			value = modifier:trade_goods_size 
		}
		multiply_variable = { 
			which = IR_goods_size
			which = IR_goods_size_mod 
		}
		###
		#change_variable = { 
		#	which = IR_demand_value
		#	which = IR_goods_size 
		#}
		change_variable = { 
			which = IR_trade_value
			which = IR_goods_size 
		}
		change_variable = {
			which = IR_logistics
			value = 1
		}
		if = { #-99.9% is the max negative consumption cost
			limit = {
				NOT = { check_variable = { which = IR_logistics value = 0.001 } }
			}
			set_variable = { which = IR_logistics value = 0.001 }
		}
		change_variable = {
			which = IR_consumption
			which = IR_logistics
		}
		multiply_variable = {
			which = IR_consumption
			which = IR_prov_pop
		}
		###
		IR_check_climate = yes
		###
		trigger_switch = {
			on_trigger = trade_goods
			grain = {
				multiply_variable = { which = IR_trade_value value = 1.5 } 
				set_variable = { which = IR_price_mod which = event_target:grain_store } 
			}
			wine = {
				multiply_variable = { which = IR_trade_value value = 2.5 } 
				set_variable = { which = IR_price_mod which = event_target:wine_store } 
			}
			wool = {
				multiply_variable = { which = IR_trade_value value = 1.5 } 
				set_variable = { which = IR_price_mod which = event_target:wool_store } 
			}
			cloth = {
				multiply_variable = { which = IR_trade_value value = 2.5 } 
				set_variable = { which = IR_price_mod which = event_target:cloth_store } 
			}
			fish = {
				multiply_variable = { which = IR_trade_value value = 1  } 
				set_variable = { which = IR_price_mod which = event_target:fish_store } 
			}
			fur = {
				multiply_variable = { which = IR_trade_value value = 2 } 
				set_variable = { which = IR_price_mod which = event_target:fur_store } 
			}
			salt = {
				multiply_variable = { which = IR_trade_value value = 2 } 
				set_variable = { which = IR_price_mod which = event_target:salt_store } 
			}
			naval_supplies = {
				multiply_variable = { which = IR_trade_value value = 2.5 } 
				set_variable = { which = IR_price_mod which = event_target:naval_supplies_store } 
			}
			copper = {
				multiply_variable = { which = IR_trade_value value = 1.5 } 
				set_variable = { which = IR_price_mod which = event_target:copper_store	} 
			}
			iron = {
				multiply_variable = { which = IR_trade_value value = 2 } 
				set_variable = { which = IR_price_mod which = event_target:iron_store } 
			}
			slaves = {
				multiply_variable = { which = IR_trade_value value = 2.5 } 
				set_variable = { which = IR_price_mod which = event_target:slaves_store } 
			}
			ivory = {
				multiply_variable = { which = IR_trade_value value = 6 } 
				set_variable = { which = IR_price_mod which = event_target:ivory_store } 
			}
			tea = {
				multiply_variable = { which = IR_trade_value value = 2.5 } 
				set_variable = { which = IR_price_mod which = event_target:tea_store } 
			}
			chinaware = {
				multiply_variable = { which = IR_trade_value value = 4 } 
				set_variable = { which = IR_price_mod which = event_target:chinaware_store } 
			}
			spices = {
				multiply_variable = { which = IR_trade_value value = 4 } 
				set_variable = { which = IR_price_mod which = event_target:spices_store } 
			}
			coffee = {
				multiply_variable = { which = IR_trade_value value = 4 } 
				set_variable = { which = IR_price_mod which = event_target:coffee_store } 
			}
			cotton = {
				multiply_variable = { which = IR_trade_value value = 4 } 
				set_variable = { which = IR_price_mod which = event_target:cotton_store } 
			}
			sugar = {
				multiply_variable = { which = IR_trade_value value = 4 } 
				set_variable = { which = IR_price_mod which = event_target:sugar_store } 
			}
			tobacco = {
				multiply_variable = { which = IR_trade_value value = 4 } 
				set_variable = { which = IR_price_mod which = event_target:tobacco_store } 
			}
			cocoa = {
				multiply_variable = { which = IR_trade_value value = 2.5 } 
				set_variable = { which = IR_price_mod which = event_target:cocoa_store } 
			}
			silk = {
				multiply_variable = { which = IR_trade_value value = 4 } 
				set_variable = { which = IR_price_mod which = event_target:silk_store } 
			}
			tropical_wood = {
				multiply_variable = { which = IR_trade_value value = 2.5 } 
				set_variable = { which = IR_price_mod which = event_target:tropical_wood_store } 
			}
			dyes = {
				multiply_variable = { which = IR_trade_value value = 4 } 
				set_variable = { which = IR_price_mod which = event_target:dyes_store } 
			}
			livestock = {
				multiply_variable = { which = IR_trade_value value = 1  } 
				set_variable = { which = IR_price_mod which = event_target:livestock_store } 
			}
			incense = {
				multiply_variable = { which = IR_trade_value value = 2.5 } 
				set_variable = { which = IR_price_mod which = event_target:incense_store } 
			}
			glass = {
				multiply_variable = { which = IR_trade_value value = 2.5 } 
				set_variable = { which = IR_price_mod which = event_target:glass_store } 
			}
			gems = {
				multiply_variable = { which = IR_trade_value value = 4 } 
				set_variable = { which = IR_price_mod which = event_target:gems_store } 
			}
			paper = {
				multiply_variable = { which = IR_trade_value value = 2.5 } 
				set_variable = { which = IR_price_mod which = event_target:paper_store } 
			}
			bt_trade_good_beer = {
				multiply_variable = { which = IR_trade_value value = 2.5 } 
				set_variable = { which = IR_price_mod which = event_target:bt_trade_good_beer_store } 
			}			
			bt_trade_good_books = {
				multiply_variable = { which = IR_trade_value value = 2.5 } 
				set_variable = { which = IR_price_mod which = event_target:bt_trade_good_books_store } 
			}
			ir_rice = {
				multiply_variable = { which = IR_trade_value value = 1  } 
				set_variable = { which = IR_price_mod which = event_target:ir_rice_store } 
			}
			ir_whales = {
				multiply_variable = { which = IR_trade_value value = 4 } 
				set_variable = { which = IR_price_mod which = event_target:ir_whales_store } 
			}
			ir_silver = {
				multiply_variable = { which = IR_trade_value value = 6 } 
				set_variable = { which = IR_price_mod which = event_target:ir_silver_store } 
			}
			ir_potatoes = {
				multiply_variable = { which = IR_trade_value value = 1.5 } 
				set_variable = { which = IR_price_mod which = event_target:ir_potatoes_store } 
			}
			ir_maize = {
				multiply_variable = { which = IR_trade_value value = 1.5 } 
				set_variable = { which = IR_price_mod which = event_target:ir_maize_store } 
			}
			ir_millet = {
				multiply_variable = { which = IR_trade_value value = 1  } 
				set_variable = { which = IR_price_mod which = event_target:ir_millet_store } 
			}
			ir_apiculture = {
				multiply_variable = { which = IR_trade_value value = 2 } 
				set_variable = { which = IR_price_mod which = event_target:ir_apiculture_store } 
			}
			ir_fruit = {
				multiply_variable = { which = IR_trade_value value = 2 } 
				set_variable = { which = IR_price_mod which = event_target:ir_fruit_store } 
			}
			ir_olives = {
				multiply_variable = { which = IR_trade_value value = 2.5 } 
				set_variable = { which = IR_price_mod which = event_target:ir_olives_store } 
			}
			ir_dates = {
				multiply_variable = { which = IR_trade_value value = 2 } 
				set_variable = { which = IR_price_mod which = event_target:ir_dates_store } 
			}
			ir_marble = {
				multiply_variable = { which = IR_trade_value value = 2.5 } 
				set_variable = { which = IR_price_mod which = event_target:ir_marble_store } 
			}
			ir_softwood = {
				multiply_variable = { which = IR_trade_value value = 1.5 } 
				set_variable = { which = IR_price_mod which = event_target:ir_softwood_store } 
			}
		}
		
		multiply_variable = {
			which = IR_trade_value
			which = IR_price_mod
		}
		change_variable = {
			which = IR_wealth_production
			which = IR_trade_value
		}
		change_variable = {
			which = IR_pop_production
			which = IR_prov_infrastructure
		}
		
		
		# TRIGGER SWITCH FOR Terrain contribution to Carrying Capacity & Growth
		trigger_switch = {
			on_trigger = has_terrain
			farmlands = { 
				change_variable = { which = IR_wealth_production value = 12 } 
				change_variable = { which = IR_pop_production value = 12 } 
				change_variable = { which = IR_prov_pop_cap value = 8 }
				set_variable = { which = IR_prov_infrastructure_cap value = 8 }
			}
			grasslands = { 
				change_variable = { which = IR_wealth_production value = 10 } 
				change_variable = { which = IR_pop_production value = 10 } 
				change_variable = { which = IR_prov_pop_cap value = 6 }
				set_variable = { which = IR_prov_infrastructure_cap value = 6 }
			}
			drylands = { 
				change_variable = { which = IR_wealth_production value = 9 } 
				change_variable = { which = IR_pop_production value = 9 } 
				change_variable = { which = IR_prov_pop_cap value = 6 }
				set_variable = { which = IR_prov_infrastructure_cap value = 6 }
			}
			#
			woods = { 
				change_variable = { which = IR_wealth_production value = 8 } 
				change_variable = { which = IR_pop_production value = 8 } 
				change_variable = { which = IR_prov_pop_cap value = 5 }
				set_variable = { which = IR_prov_infrastructure_cap value = 5 }
			}
			marsh = { 
				change_variable = { which = IR_wealth_production value = 8 } 
				change_variable = { which = IR_pop_production value = 6 } 
				change_variable = { which = IR_prov_pop_cap value = 5 }
				set_variable = { which = IR_prov_infrastructure_cap value = 5 }
			}
			hills = { 
				change_variable = { which = IR_wealth_production value = 5 } 
				change_variable = { which = IR_pop_production value = 5 } 
				change_variable = { which = IR_prov_pop_cap value = 5 }
				set_variable = { which = IR_prov_infrastructure_cap value = 4 }
			}
			#
			jungle = { 
				change_variable = { which = IR_wealth_production value = 5 } 
				change_variable = { which = IR_pop_production value = 6 } 
				change_variable = { which = IR_prov_pop_cap value = 4 } 
				set_variable = { which = IR_prov_infrastructure_cap value = 4 }
			}
			coastline = { 
				change_variable = { which = IR_wealth_production value = 6 } 
				change_variable = { which = IR_pop_production value = 5 } 
				change_variable = { which = IR_prov_pop_cap value = 4 }
				set_variable = { which = IR_prov_infrastructure_cap value = 5 }
			}
			steppe = { 
				change_variable = { which = IR_wealth_production value = 4 } 
				change_variable = { which = IR_pop_production value = 5 } 
				change_variable = { which = IR_prov_pop_cap value = 4 }
				set_variable = { which = IR_prov_infrastructure_cap value = 4 }
			}
			#
			highlands = { 
				change_variable = { which = IR_wealth_production value = 3 } 
				change_variable = { which = IR_pop_production value = 4 } 
				change_variable = { which = IR_prov_pop_cap value = 4 }
				set_variable = { which = IR_prov_infrastructure_cap value = 3 }
			}
			savannah = { 
				change_variable = { which = IR_wealth_production value = 3 } 
				change_variable = { which = IR_pop_production value = 4 } 
				change_variable = { which = IR_prov_pop_cap value = 4 }
				set_variable = { which = IR_prov_infrastructure_cap value = 4 }
			}
			coastal_desert = { 
				change_variable = { which = IR_wealth_production value = 4 } 
				change_variable = { which = IR_pop_production value = 3 } 
				change_variable = { which = IR_prov_pop_cap value = 2 }
				set_variable = { which = IR_prov_infrastructure_cap value = 2 }
			}
			#
			forest = { 
				change_variable = { which = IR_wealth_production value = 3 } 
				change_variable = { which = IR_pop_production value = 3 } 
				change_variable = { which = IR_prov_pop_cap value = 3 }
				set_variable = { which = IR_prov_infrastructure_cap value = 2 }
			}
			mountain = { 
				change_variable = { which = IR_wealth_production value = 3 } 
				change_variable = { which = IR_pop_production value = 2 } 
				change_variable = { which = IR_prov_pop_cap value = 3 } 
				set_variable = { which = IR_prov_infrastructure_cap value = 2 }
			}
			badlands = { 
				change_variable = { which = IR_wealth_production value = 2 } 
				change_variable = { which = IR_pop_production value = 2 } 
				change_variable = { which = IR_prov_pop_cap value = 2 }
				set_variable = { which = IR_prov_infrastructure_cap value = 2 }
			}
			#
			tundra = { 
				change_variable = { which = IR_wealth_production value = 2 } 
				change_variable = { which = IR_pop_production value = 1 } 
				change_variable = { which = IR_prov_pop_cap value = 1 }
				set_variable = { which = IR_prov_infrastructure_cap value = 2 }
			}
			desert = { 
				change_variable = { which = IR_wealth_production value = 3 } 
				change_variable = { which = IR_pop_production value = 2 } 
				change_variable = { which = IR_prov_pop_cap value = 1 }
				set_variable = { which = IR_prov_infrastructure_cap value = 2 }
			}
			glacier = { 
				change_variable = { which = IR_wealth_production value = 1 } 
				change_variable = { which = IR_pop_production value = 1 } 
				change_variable = { which = IR_prov_pop_cap value = 1 }
				set_variable = { which = IR_prov_infrastructure_cap value = 1 }
			}
		}
		## terrain features
		trigger_switch = { #for ones that will never cross over - slightly reduces calc
			on_trigger = has_province_modifier
			atoll = {
				change_variable = { which = IR_pop_production value = 2 } 
				change_variable = { which = IR_prov_pop_cap value = 2 }
				subtract_variable = { which = IR_prov_infrastructure_cap value = 2 }
				change_variable = { which = IR_InfrPrjCC value = 2 }
				subtract_variable = { which = IR_InfrPrjIL value = 2 }
			}
			barrier_islands = {
				change_variable = { which = IR_prov_pop_cap value = 2 }
				change_variable = { which = IR_prov_infrastructure_cap value = 1 }
				change_variable = { which = IR_InfrPrjCC value = 2 }
				change_variable = { which = IR_InfrPrjIL value = 1 }
			}
			cliff = {
				subtract_variable = { which = IR_prov_pop_cap value = 1 }
				subtract_variable = { which = IR_prov_infrastructure_cap value = 1 }
				subtract_variable = { which = IR_InfrPrjCC value = 1 }
				subtract_variable = { which = IR_InfrPrjIL value = 1 }
			}
			canyon = {
				change_variable = { which = IR_pop_production value = 1 } 
				change_variable = { which = IR_prov_pop_cap value = 1 }
				subtract_variable = { which = IR_prov_infrastructure_cap value = 2 }
				change_variable = { which = IR_InfrPrjCC value = 1 }
				subtract_variable = { which = IR_InfrPrjIL value = 2 }
			}
			cove = {
				change_variable = { which = IR_prov_pop_cap value = 1 }
				change_variable = { which = IR_prov_infrastructure_cap value = 2 }
				change_variable = { which = IR_InfrPrjCC value = 1 }
				change_variable = { which = IR_InfrPrjIL value = 2 }
			}
			valley = {
				change_variable = { which = IR_pop_production value = 3 } 
				change_variable = { which = IR_prov_pop_cap value = 1 }
				change_variable = { which = IR_prov_infrastructure_cap value = 2 }
				change_variable = { which = IR_InfrPrjCC value = 1 }
				change_variable = { which = IR_InfrPrjIL value = 2 }
			}
			fjord = {
				change_variable = { which = IR_pop_production value = 1 } 
				change_variable = { which = IR_prov_pop_cap value = 2 }
				subtract_variable = { which = IR_prov_infrastructure_cap value = 2 }
				change_variable = { which = IR_InfrPrjCC value = 2 }
				subtract_variable = { which = IR_InfrPrjIL value = 2 }
			}
			plateau = {
				change_variable = { which = IR_prov_pop_cap value = 1 }
				subtract_variable = { which = IR_prov_infrastructure_cap value = 1 }
				change_variable = { which = IR_InfrPrjCC value = 1 }
				subtract_variable = { which = IR_InfrPrjIL value = 1 }
			}
			wadi = {
				change_variable = { which = IR_pop_production value = 1 } 
				change_variable = { which = IR_prov_pop_cap value = 2 }
				change_variable = { which = IR_InfrPrjCC value = 2 }
			}
			oasis = {
				change_variable = { which = IR_pop_production value = 2 } 
				change_variable = { which = IR_prov_pop_cap value = 2 }
				change_variable = { which = IR_prov_infrastructure_cap value = 2 }
				change_variable = { which = IR_InfrPrjCC value = 2 }
				change_variable = { which = IR_InfrPrjIL value = 2 }
			}
			volcano = {
				change_variable = { which = IR_prov_pop_cap value = 3 }
				subtract_variable = { which = IR_prov_infrastructure_cap value = 1 }
				change_variable = { which = IR_InfrPrjCC value = 3 }
				subtract_variable = { which = IR_InfrPrjIL value = 1 }
			}
			doab = {
				change_variable = { which = IR_pop_production value = 3 } 
				change_variable = { which = IR_prov_pop_cap value = 3 }
				change_variable = { which = IR_prov_infrastructure_cap value = 2 }
				change_variable = { which = IR_InfrPrjCC value = 3 }
				change_variable = { which = IR_InfrPrjIL value = 2 }
			}
		}
		if = {
			limit = { has_province_modifier = marsh_feature }
			subtract_variable = { which = IR_pop_production value = 2 } 
			subtract_variable = { which = IR_prov_pop_cap value = 1 }
			subtract_variable = { which = IR_prov_infrastructure_cap value = 2 }
			subtract_variable = { which = IR_InfrPrjCC value = 1 }
			subtract_variable = { which = IR_InfrPrjIL value = 2 }
		}
		if = {
			limit = { has_province_modifier = swamp }
			subtract_variable = { which = IR_pop_production value = 2 } 
			subtract_variable = { which = IR_prov_pop_cap value = 2 }
			subtract_variable = { which = IR_prov_infrastructure_cap value = 2 }
			subtract_variable = { which = IR_InfrPrjCC value = 2 }
			subtract_variable = { which = IR_InfrPrjIL value = 2 }
		}
		if = {
			limit = { has_province_modifier = bog }
			subtract_variable = { which = IR_pop_production value = 2 } 
			subtract_variable = { which = IR_prov_pop_cap value = 1 }
			subtract_variable = { which = IR_prov_infrastructure_cap value = 3 }
			subtract_variable = { which = IR_InfrPrjCC value = 1 }
			subtract_variable = { which = IR_InfrPrjIL value = 3 }
		}
		if = {
			limit = { has_province_modifier = bayou }
			subtract_variable = { which = IR_prov_pop_cap value = 1 }
			change_variable = { which = IR_prov_infrastructure_cap value = 2 }
			subtract_variable = { which = IR_InfrPrjCC value = 1 }
			change_variable = { which = IR_InfrPrjIL value = 2 }
		}
		if = {
			limit = { has_province_modifier = floodplain }
			change_variable = { which = IR_pop_production value = 4 } 
			change_variable = { which = IR_prov_pop_cap value = 2 }
			subtract_variable = { which = IR_prov_infrastructure_cap value = 2 }
			change_variable = { which = IR_InfrPrjCC value = 2 }
			subtract_variable = { which = IR_InfrPrjIL value = 2 }
		}
		if = {
			limit = { has_province_modifier = lakeshore }
			change_variable = { which = IR_pop_production value = 1 } 
			change_variable = { which = IR_prov_pop_cap value = 1 }
			change_variable = { which = IR_prov_infrastructure_cap value = 1 }
			change_variable = { which = IR_InfrPrjCC value = 1 }
			change_variable = { which = IR_InfrPrjIL value = 1 }
		}
		

		## infr prj
		if = {
			limit = { has_province_modifier = irrigation }
			change_variable = { which = IR_pop_production value = 6 } 
			change_variable = { which = IR_prov_pop_cap value = 2 }
			change_variable = { which = IR_prov_infrastructure_cap value = 1 }
			change_variable = { which = IR_InfrPrjCC value = 2 }
			change_variable = { which = IR_InfrPrjIL value = 1 }
		}
		if = {
			limit = { has_province_modifier = gardens }
			change_variable = { which = IR_pop_production value = 2 } 
			change_variable = { which = IR_prov_pop_cap value = 3 }
			change_variable = { which = IR_prov_infrastructure_cap value = 1 }
			change_variable = { which = IR_InfrPrjCC value = 3 }
			change_variable = { which = IR_InfrPrjIL value = 1 }
		}
		if = {
			limit = { has_province_modifier = wells }
			change_variable = { which = IR_pop_production value = 4 } 
			change_variable = { which = IR_prov_pop_cap value = 4 }
			change_variable = { which = IR_prov_infrastructure_cap value = 1 }
			change_variable = { which = IR_InfrPrjCC value = 4 }
			change_variable = { which = IR_InfrPrjIL value = 1 }
		}
		if = {
			limit = { has_province_modifier = terrace }
			change_variable = { which = IR_pop_production value = 3 } 
			change_variable = { which = IR_prov_pop_cap value = 3 }
			change_variable = { which = IR_prov_infrastructure_cap value = 3 }
			change_variable = { which = IR_InfrPrjCC value = 3 }
			change_variable = { which = IR_InfrPrjIL value = 3 }
		}
		if = {
			limit = { has_province_modifier = dikes }
			change_variable = { which = IR_prov_pop_cap value = 5 }
			change_variable = { which = IR_prov_infrastructure_cap value = 5 }
			change_variable = { which = IR_InfrPrjCC value = 5 }
			change_variable = { which = IR_InfrPrjIL value = 5 }
		}
		if = {
			limit = { has_province_modifier = breakwaters } 
			change_variable = { which = IR_prov_pop_cap value = 1 }
			change_variable = { which = IR_prov_infrastructure_cap value = 2 }
			change_variable = { which = IR_InfrPrjCC value = 1 }
			change_variable = { which = IR_InfrPrjIL value = 2 }
		}
		if = {
			limit = { has_province_modifier = lighthouse }
			change_variable = { which = IR_prov_infrastructure_cap value = 2 }
			change_variable = { which = IR_InfrPrjIL value = 2 }
		}
		if = {
			limit = { has_province_modifier = dam }
			change_variable = { which = IR_pop_production value = 2 } 
			change_variable = { which = IR_prov_pop_cap value = 4 }
			change_variable = { which = IR_prov_infrastructure_cap value = 4 }
			change_variable = { which = IR_InfrPrjCC value = 4 }
			change_variable = { which = IR_InfrPrjIL value = 4 }
		}
		if = {
			limit = { has_province_modifier = windmills }
			change_variable = { which = IR_pop_production value = 2 } 
			change_variable = { which = IR_prov_pop_cap value = 2 }
			change_variable = { which = IR_prov_infrastructure_cap value = 2 }
			change_variable = { which = IR_InfrPrjCC value = 2 }
			change_variable = { which = IR_InfrPrjIL value = 2 }
		}
		##
		#famine %
		set_variable = { which = IR_prov_famine_chance value = 0 }
		change_variable = {
			which = IR_prov_famine_chance
			which = IR_consumption
		}
		subtract_variable = {
			which = IR_prov_famine_chance
			which = IR_pop_production
		}
		multiply_variable = {
			which = IR_prov_famine_chance
			value = 10
		}
		change_variable = {
			which = IR_prov_famine_chance
			which = IR_prov_pop
		}
		subtract_variable = {
			which = IR_prov_famine_chance
			which = IR_prov_pop_cap
		}
		
		if = {  #SET TO 0 IF BELOW 1
			limit = {
				NOT = { check_variable = { which = IR_prov_famine_chance value = 1 } }
			}
			set_variable = {
				which = IR_prov_famine_chance
				value = 0
			}
		}
		else_if = {  #SET TO 100 IF above 100.01
			limit = {
				check_variable = { which = IR_prov_famine_chance value = 100.01 }
			}
			set_variable = {
				which = IR_prov_famine_chance
				value = 100
			}
		}
		
		### 
		#infrastructure cap
		trigger_switch = { 
			on_trigger = has_building
			village = { 
				change_variable = {
					which = IR_prov_infrastructure_cap 
					value = 5
				}
			}
			town = { 
				change_variable = {
					which = IR_prov_infrastructure_cap 
					value = 10
				}
			}
			city = {
				change_variable = {
					which = IR_prov_infrastructure_cap 
					value = 15
				}
			} 
			metropolis = { 
				change_variable = {
					which = IR_prov_infrastructure_cap 
					value = 20
				}
			}
		}
		trigger_switch = {
			on_trigger = has_building
			road = {
				change_variable = {
					which = IR_prov_infrastructure_cap 
					value = 2
				}
			} 
			railroad = {
				change_variable = {
					which = IR_prov_infrastructure_cap 
					value = 5
				}
			} 
		}
	}
}

IR_dev_calc = {
	hidden_effect = {
	#IR_check_dev_variables = yes
		change_variable = {
			which = IR_pop_progress
			which = IR_pop_production
		}
		subtract_variable = {
			which = IR_pop_progress
			which = IR_consumption
		}
		divide_variable = {
			which = IR_wealth_production
			which = IR_logistics
		}
		change_variable = {
			which = IR_wealth_progress
			which = IR_wealth_production
		}
			
		#WEALTH CALC
		if = {
			limit = { 
				check_variable = { which = IR_wealth_progress value = 100 }
			}
			add_base_tax = 1
			set_variable = {
				which = IR_wealth_progress
				value = 1
			}
		}
		#else_if = { # lose wealth
		#	limit = { NOT = { check_variable = { which = IR_wealth_progress value = 1 } } }
		#	if = {
		#		limit = { base_tax = 2 }
		#		add_base_tax = -1
		#	}
		#	set_variable = {
		#		which = IR_wealth_progress
		#		value = 99
		#	}
		#}
		#POP CALC
		if = {
			limit = { 
				check_variable = { which = IR_pop_progress value = 100 }
			}
			add_base_manpower = 1
			set_variable = {
				which = IR_pop_progress
				value = 1
			}
		}
		else_if = { # lose wealth
			limit = { NOT = { check_variable = { which = IR_pop_progress value = 1 } } }
			if = {
				limit = { base_manpower = 2 }
				add_base_manpower = -1
			}
			set_variable = {
				which = IR_pop_progress
				value = 99
			}
		}
		
		trigger_switch = { 
			on_trigger = has_building
			metropolis = { 
		#		event_target:glass_store = { change_variable = { which = IR_demand_value value = PREV } }		
				if = {
					limit = { NOT = { base_manpower = 30 } }
					remove_building = metropolis
					add_building = city
				}
			}
			city = {
		#		event_target:glass_store = { change_variable = { which = IR_demand_value value = PREV } }
				if = {
					limit = { NOT = { base_manpower = 20 } }
					remove_building = city
					add_building = town
				}
			} 
			town = { 
		#		event_target:glass_store = { change_variable = { which = IR_demand_value value = PREV } }
				if = {
					limit = { NOT = { base_manpower = 10 } }
					remove_building = town
					add_building = village
				}
			}			
			village = { 
		#		event_target:glass_store = { change_variable = { which = IR_demand_value value = PREV } }
				if = {
					limit = { NOT = { base_manpower = 5 } }
					remove_building = village
				}
			}			
		}
		
		#trigger_switch = {
		#	on_trigger = trade_goods
			#grain = {
			#	event_target:grain_store = { change_variable = { which = IR_goods_size which = PREV } }
			#	
			#}
			#wine = {
			#	event_target:wine_store = { change_variable = { which = IR_goods_size which = PREV } }
			#	divide_variable = { which = IR_demand_value value = 2 }
			#	event_target:glass_store = { change_variable = { which = IR_demand_value which = PREV } }
			#}
			#wool = {
			#	event_target:wool_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#cloth = {
			#	event_target:cloth_store = { change_variable = { which = IR_goods_size which = PREV } }
			#	multiply_variable = { which = IR_demand_value value = 2 }
			#	event_target:wool_store = { change_variable = { which = IR_demand_value which = PREV } }
			#}
			#fish = {
			#	event_target:fish_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#fur = {
			#	event_target:fur_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#salt = {
			#	event_target:salt_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#naval_supplies = {
			#	event_target:naval_supplies_store = { change_variable = { which = IR_goods_size which = PREV } }
			#	divide_variable = { which = IR_demand_value value = 2 }
			#	event_target:softwood_store = { change_variable = { which = IR_demand_value which = PREV } }
			#	event_target:hardwood_store = { change_variable = { which = IR_demand_value which = PREV } }
			#	divide_variable = { which = IR_demand_value value = 2 }
			#	event_target:salt_store = { change_variable = { which = IR_demand_value which = PREV } }
			#}
			#copper = {
			#	event_target:copper_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#iron = {
			#	event_target:iron_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#slaves = {
			#	event_target:slaves_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#ivory = {
			#	event_target:ivory_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#tea = {
			#	event_target:tea_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#chinaware = {
			#	event_target:porcelain_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#spices = {
			#	event_target:spices_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#coffee = {
			#	event_target:coffee_store = { change_variable = { which = IR_goods_size which = PREV } }
			#	divide_variable = { which = IR_demand_value value = 2 }
			#	event_target:slaves_store = { change_variable = { which = IR_demand_value which = PREV } }
			#}
			#cotton = {
			#	event_target:cotton_store = { change_variable = { which = IR_goods_size which = PREV } }
			#	divide_variable = { which = IR_demand_value value = 2 }
			#	event_target:slaves_store = { change_variable = { which = IR_demand_value which = PREV } }
			#}
			#sugar = {
			#	event_target:sugar_store = { change_variable = { which = IR_goods_size which = PREV } }
			#	divide_variable = { which = IR_demand_value value = 2 }
			#	event_target:slaves_store = { change_variable = { which = IR_demand_value which = PREV } }
			#}
			#tobacco = {
			#	event_target:tobacco_store = { change_variable = { which = IR_goods_size which = PREV } }
			#	divide_variable = { which = IR_demand_value value = 2 }
			#	event_target:slaves_store = { change_variable = { which = IR_demand_value which = PREV } }
			#}
			#cocoa = {
			#	event_target:cocoa_store = { change_variable = { which = IR_goods_size which = PREV } }
			#	divide_variable = { which = IR_demand_value value = 2 }
			#	event_target:slaves_store = { change_variable = { which = IR_demand_value which = PREV } }
			#}
			#silk = {
			#	event_target:silk_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#tropical_wood = {
			#	event_target:hardwood_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#dyes = {
			#	event_target:dyes_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#livestock = {
			#	event_target:livestock_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#incense = {
			#	event_target:incense_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#glass = {
			#	event_target:glass_store = { change_variable = { which = IR_goods_size which = PREV } }
			#	
			#}
			#gems = {
			#	event_target:gems_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#paper = {
			#	event_target:paper_store = { change_variable = { which = IR_goods_size which = PREV } }
			#	multiply_variable = { which = IR_demand_value value = 2 }
			#	event_target:softwood_store = { change_variable = { which = IR_demand_value which = PREV } }
			#}
			#bt_trade_good_beer = {
			#	event_target:bt_trade_good_beer_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}			
			#bt_trade_good_books = {
			#	event_target:bt_trade_good_books_store = { change_variable = { which = IR_goods_size which = PREV } }
			#	multiply_variable = { which = IR_demand_value value = 2 }
			#	event_target:paper_store = { change_variable = { which = IR_demand_value which = PREV } }
			#}
			#ir_rice = {
			#	event_target:ir_rice_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#ir_whales = {
			#	event_target:ir_whales_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#ir_silver = {
			#	event_target:ir_silver_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#ir_potatoes = {
			#	event_target:ir_potato_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#ir_maize = {
			#	event_target:ir_maize_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#ir_millet = {
			#	event_target:ir_millet_store = { change_variable = { which = IR_goods_size which = PREV } } 
			#}
			#ir_apiculture = {
			#	event_target:ir_apiculture_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#ir_fruit = {
			#	event_target:ir_fruit_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#ir_olives = {
			#	event_target:ir_olives_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#ir_dates = {
			#	event_target:ir_dates_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#ir_marble = {
			#	event_target:ir_marble_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#ir_softwood = {
			#	event_target:ir_softwood_store = { change_variable = { which = IR_goods_size which = PREV } }
			#}
			#all
			#set_variable = { which = IR_demand_value which = IR_prov_pop }
			#event_target:market_food = { change_variable = { which = IR_demand_value which = PREV } }
		#}

		#Famine calc
		if = {
			limit = { base_manpower = 2 } #WILL ONLY CHECK IF YOU HAVE POPULATION TO LOSE - OTHERWISE IS MOOT
			IR_check_famine = yes
		}
	}
}

#subjects
IR_check_subj_variables = {
	hidden_effect = {
		set_variable = { which = IR_subj_opinion value = 0 }
		set_variable = { which = IR_subj_cohesion_growth value = 0 }
		set_variable = { which = IR_subj_dev value = 0 }
		
		#EXPORT OPINION AND TRUST
		export_to_variable = {
			variable_name = IR_subj_opinion
			value = opinion
			#who = ROOT
			with = overlord
		}
		export_to_variable = {
			variable_name = IR_subj_cohesion_growth
			value = trust
			#who = ROOT
			with = overlord
		}
		export_to_variable = {
			variable_name = IR_subj_dev
			value = trigger_value:total_development
		}
		#MODIFIER OPINION AND TRUST FOR COHESION GROWTH
		#divide_variable = {
		#	which = IR_subj_opinion
		#	value = 100
		#}
		#subtract_variable = {
		#	which = IR_subj_cohesion_growth
		#	value = 20
		#}
		#divide_variable = {
		#	which = IR_subj_cohesion_growth
		#	value = 20
		#}
		change_variable = {
			which = IR_subj_cohesion_growth
			which = IR_subj_opinion
		}
		divide_variable = {
			which = IR_subj_cohesion_growth
			which = IR_subj_dev
		}
		trigger_switch = {
			on_trigger = current_age 
			age_of_discovery = {
				divide_variable = {
					which = IR_subj_cohesion_growth
					value = 2.5
				}
			}
			age_of_reformation = {
				divide_variable = {
					which = IR_subj_cohesion_growth
					value = 1.25
				}
			}			
			age_of_absolutism = {
				divide_variable = {
					which = IR_subj_cohesion_growth
					value = 0.75
				}				
			}			
			age_of_revolutions = {
				divide_variable = {
					which = IR_subj_cohesion_growth
					value = 0.5
				}				
			}		
		}
		if = {
			limit = { NOT = { overlord = { is_neighbor_of = ROOT } } }
			divide_variable = {
				which = IR_subj_cohesion_growth
				value = 3
			}
		}
	}
}

IR_subj_calc = {
	hidden_effect = {
		change_variable = {
			which = IR_subj_cohesion
			which = IR_subj_cohesion_growth
		}
		if = {
			limit = { check_variable = { which = IR_subj_cohesion value = 100.01 } }
			set_variable = {
				which = IR_subj_cohesion
				value = 100
			}
		}
		if = {
			limit = { NOT = { check_variable = { which = IR_subj_cohesion value = 0 } } }
			set_variable = {
				which = IR_subj_cohesion
				value = 0
			}
		}
	}
}